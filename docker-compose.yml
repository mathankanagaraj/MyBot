services:
  # Angel One Trading Bot - Indian Markets (IST)
  angel_bot:
    build:
      context: .
      dockerfile: Dockerfile # Uses shared image
    image: angel_bot:latest # Unique image name
    container_name: angel_options_bot
    env_file: .env
    environment:
      - TZ=Asia/Kolkata # Override timezone at runtime
      - BROKER=ANGEL # Override broker at runtime
    volumes:
      - ./logs:/app/logs
      - ./audit:/app/audit
    restart: "unless-stopped" # Auto-restart on crash/reboot

  # IBKR Trading Bot - US Markets (ET)
  ibkr_bot:
    build:
      context: .
      dockerfile: Dockerfile # Uses same shared image
    image: ibkr_bot:latest # Unique image name
    container_name: ibkr_options_bot
    env_file: .env
    environment:
      - TZ=America/New_York # Override timezone at runtime
      - BROKER=IBKR # Override broker at runtime
      - IB_HOST=host.docker.internal
    volumes:
      - ./logs:/app/logs
      - ./audit:/app/audit
    restart: "unless-stopped" # Auto-restart on crash/reboot
